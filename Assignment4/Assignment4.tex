\documentclass[11pt,letter, swedish, english
]{article}
\pdfoutput=1

\usepackage{../custom_as}

\renewcommand{\thesubsection}{\arabic{section} (\alph{subsection})}

\renewcommand{\thesubsubsection}{\arabic{section} (\alph{subsection},\,\roman{subsubsection})}


%%Drar in tabell och figurtexter
\usepackage[margin=10 pt]{caption}
%%För att lägga in 'att göra'-noteringar i texten
\usepackage{todonotes} %\todo{...}

%%För att själv bestämma marginalerna. 
\usepackage[
%            top    = 3cm,
%            bottom = 3cm,
%            left   = 3cm, right  = 3cm
]{geometry}

\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}
\newcommand{\oh}{\ensuremath\mathpzc{o}}

\newcommand{\as}{\qcomma\text{as }}

\renewcommand{\thefootnote}{\fnsymbol{footnote}}

\begin{document}

%%%%%%%%%%%%%%%%% vvv Inbyggd titelsida vvv %%%%%%%%%%%%%%%%%
% \begin{titlepage}
\title{Asymptotic Analasys and Pertubation Theory -- AMATH\,732 \\
Assignment 4}
\author{Andréas Sundström}
\date{\today}

\maketitle

%%%%%%%%%%%%%%%%% ^^^ Inbyggd titelsida ^^^ %%%%%%%%%%%%%%%%%

%Om man vill ha en lista med vilka todo:s som finns.
%\todolist

\section{An IVP}
Here we have
\begin{equation}\label{eq:1_IVP}
y''+(1-\epsilon x)y=0;\qquad
y(0)=1,\quad y'(0)=0
\end{equation}
where $0<\epsilon\ll1$ and $0\le x<\infty$. We want to find the RPT
solution. 

As ususal we begin by assuming
\begin{equation}
y(x, \epsilon)=y_0(x) + \epsilon y_1(x) + \epsilon^2 y_2(x)+\ldots,
\end{equation}
which, after collection of like powers of $\epsilon$ gives
\begin{equation}
\qty(y_0''+y) +\epsilon\qty(y_1''+y_1-xy_0) 
+\epsilon^2\qty(y_2''+y_2-xy_1) +\ldots=0.
\end{equation}

The order 1 problem is just
\begin{equation}
y_0''+y_0=0;\qquad
y_0(0)=1,\quad y_0'(0)=0,
\end{equation}
which has the solution
\begin{equation}
y_0(x)=\cos(x).
\end{equation}

The next order problem thus becomes
\begin{equation}
y_1''+y_1=xy_0=x\cos(x)
\end{equation}
with initial conditions $y_1(0)=0$ and $y_1'(0)=0$. Here we have the
homogeneuos solution
\begin{equation}
y_1^{(\text{h})}(x)=A_1\cos(x)+B_1\sin(x),
\end{equation}
and the particular solution should have the form
\begin{equation}
y_1^{(\text{p})}(x)=\qty(a_1x+a_1'x^2)\cos(x)+\qty(b_1x+b_1'x^2)\sin(x).
\end{equation}
Alternatievly you could use \textit{Mathematica} (which I did), or
some other computer program, to find that the particular solution is 
\begin{equation}
y_1^{(\text{p})}(x)=\frac{1}{8}\qty[
2x\cos(x)+\qty(-1+2x^2)\sin(x)].
\end{equation}
Then we invoke the initial conditions. For $y(0)=0$, we see that
$y_1^{(\text{p})}(0)=0$ so $A_1=0$. For the first derivative it's easy
to see that the only contribution from ${y_1'}^{(\text{p})}(0)$ must
come from the $x\cos(x)$ and $-sin(x)$ terms in $y_1^{(\text{p})}$,
and we get
\begin{equation}
B_1+\frac{1}{4}-\frac{1}{8}=0
\quad\Longrightarrow\quad
B_1=-\frac{1}{8}.
\end{equation}
In other words the final solution to the order $\epsilon^1$ problem is
\begin{equation}
\begin{aligned}
y_1(x)=&\frac{1}{8}\qty[2x\cos(x)+\qty(-1+2x^2)\sin(x)-\sin(x)]\\
=&\frac{1}{4}\qty[x\cos(x)+\qty(-1+x^2)\sin(x)].
\end{aligned}
\end{equation}

Already we can see that this is not going very well. The
$\order{\epsilon}$ solution, $y_1$, grows and blows up as
$x\to\infty$, whereas $y_0$ is bounded. This means that the RPT
solution is \emph{not} uniformly ordered. The exact solution to
\eqref{eq:1_IVP} will however not be bounded, since for
$x>\epsilon^{-1}$ we get exponential behaviour. The problem of
non-uniformity is however that the approximation that a truncated
expansion does not hold for $x\gg\epsilon^{-1}$. 






\section{Underdamped linear damped oscillator}
Here we have the underdamped oscillator
\begin{equation}
\ddot{x}+2\epsilon\dot{x}+x=0;\qquad
x(0)=1,\quad \dot{x}(0)=0,
\end{equation}
with $0<\epsilon\ll1$.


\subsection{Introducing new time scales}
We begin by introducin two new, slow, time scales $\tau_1=\epsilon x$
and $\tau_2=\epsilon^2 x$. We now have
\begin{equation}
x(t)=f(t, \tau_1, \tau_2, \epsilon),
\end{equation}
where we treat $t$, $\tau_1$ and $\tau_2$ as independen variabels. 
As such the total derivative must change:
\begin{equation}
\dv{t}=\pdv{t}{t}\pdv{t}+\pdv{\tau_1}{t}\pdv{\tau_1}
+\pdv{\tau_2}{t}\pdv{\tau_2}
=\pdv{t}+\epsilon\pdv{\tau_1}+\epsilon^2\pdv{\tau_2}. 
\end{equation}

With this information the $t$ derivatives of $x$ becomes
\begin{equation}
\dot{x}=\dv{t}f
=f_t + \epsilon f_{\tau_1}+\epsilon^2 f_{\tau_2}
\end{equation}
and
\begin{equation}
\begin{aligned}
\ddot{x}=\dv{t}\qty[\dv{t}f]
=&f_{tt}+\epsilon f_{t,\tau_1}+\epsilon^2 f_{t,\tau_2}
+\epsilon\qty(
f_{\tau_1,t}+\epsilon f_{\tau_1,\tau_1}+\epsilon^2f_{\tau_1,\tau_2})
\\ 
&+\epsilon^2\qty(
f_{\tau_2,t}+\epsilon f_{\tau_2,\tau_1}+\epsilon^2f_{\tau_2,\tau_2})
\\
=&f_{tt} + 2\epsilon f_{t,\tau_1} 
+ \epsilon^2 f_{\tau_1,\tau_1} + 2\epsilon^2 f_{t,\tau_2}
+\order{\epsilon^3}.
\end{aligned}
\end{equation}

Thus the original DE now becomes
\begin{equation}\label{eq:2_DE_f}
\qty(f_{tt} + 2\epsilon f_{t,\tau_1} 
+ \epsilon^2 f_{\tau_1,\tau_1} + 2\epsilon^2 f_{t,\tau_2})
+2\epsilon\qty(f_t + \epsilon f_{\tau_1})
+f+\order{\epsilon^3}=0.
\end{equation}
And the inital conditions are
\begin{equation}\label{eq:2_init}
f(0, 0, 0, \epsilon)=1
\end{equation}
and
\begin{equation}\label{eq:2_init_d0}
f_t(0, 0, 0, \epsilon) + \epsilon f_{\tau_1}(0, 0, 0,
\epsilon)+\epsilon^2 f_{\tau_2}(0, 0, 0, \epsilon)
=0
\end{equation}
for all $\epsilon$. 

% That it's for all $\epsilon$ means that
% \begin{equation}\label{eq:2_init_d}
% f_t(0, 0, 0, \epsilon) = f_{\tau_1}(0, 0, 0, \epsilon)
% = f_{\tau_2}(0, 0, 0, \epsilon)
% =0.
% \end{equation}



\subsection{Leading order problem}
Now we continue on to expanding
\begin{equation}
f(t, \tau_1, \tau_2, \epsilon)=
f_0(t, \tau_1, \tau_2, \epsilon) 
+\epsilon f_1(t, \tau_1, \tau_2, \epsilon) 
+\epsilon^2 f_2(t, \tau_1, \tau_2, \epsilon)+\ldots 
\end{equation}
The $\order{1}$ problem
\begin{equation}
f_{0\;t,t}+f_0=0
\end{equation}
does look a lot like the original leading order problem. But with one
important difference: this is a \emph{partial} DE, meaning that
\begin{equation}\label{eq:2_f0}
f_0=A_0(\tau_1, \tau_2)\cos(t)+B_0(\tau_1, \tau_2)\sin(t),
\end{equation}
but here $A_0$ and $B_0$ now depends on $\tau_1$ and $\tau_2$.

With the inital conditions we get:
\begin{equation}\label{eq:2b_init_A}
\eqref{eq:2_init}\quad\Longrightarrow\quad
A_0(0, 0)=1.
\end{equation}
But with \eqref{eq:2_init_d0} we run into trubble, since
with the expansion \eqref{eq:2_init_d0} becomes
\begin{equation}\label{eq:2_init_d}
\qty[f_{0\,t}+\epsilon\Big(f_{0\;\tau_1}+f_{1\;t} \Big)
+\epsilon^2\Big(f_{0\;\tau_2}+f_{1\;\tau_1}+f_{2\;t} \Big)
+\order{\epsilon^3}]_{t=\tau_1=\tau_2=0}=0.
\end{equation}
This is true for all $\epsilon$ and since $f_i$ does not depend on
$\epsilon$ we must have that all coefficients must be 0. Therefore all
we can say so far is that
\begin{equation}
f_{0\;t}(0, 0)=0, 
\end{equation}
which gives
\begin{equation}\label{eq:2b_init_B}
B_0(0, 0)=0.
\end{equation}

\subsection{First solvability condition}
For the $\order{\epsilon}$ problem \eqref{eq:2_DE_f} gives
\begin{equation}\label{eq:2c_f1_0}
f_{1\;t,t}+f_1 + 2f_{0\;t,\tau_1} +2f_{0\;t}=0
\end{equation}
or in other words
\begin{equation}\label{eq:2c_f1_1}
\begin{aligned}
f_{1\;t,t}+f_1 = -2f_{0\;t,\tau_1} -2f_{0\;t}
=&2A_0(\tau_1, \tau_2)\sin(t) - 2B_0(\tau_1, \tau_2)\cos(t)\\
&+ 2A_{0\;\tau_1}(\tau_1, \tau_2)\sin(t) 
- 2B_{0\;\tau_1}(\tau_1, \tau_2)\cos(t).
\end{aligned}
\end{equation}

To eliminate secular terms we must have
\begin{equation}
\begin{cases}
A_{0\;\tau_1}+A_0=0\\
B_{0\;\tau_1}+B_0=0,
\end{cases}
\end{equation}
which of couse have the solutions
\begin{equation}
A_0(\tau_1, \tau_2)=\tilde{A}_0(\tau_2)\ee^{-\tau_1}
\end{equation}
and
\begin{equation}
B_0(\tau_1, \tau_2)=\tilde{B}_0(\tau_2)\ee^{-\tau_1}.
\end{equation}
The inital conditions for $\tilde{A}_0$ and $\tilde{B}_0$ are
\begin{equation}\label{eq:2_init_tildeA}
\eqref{eq:2b_init_A}\quad\Longrightarrow\quad
\tilde{A}_0(0)=1,
\end{equation}
and
\begin{equation}\label{eq:2_init_tildeB}
\eqref{eq:2b_init_B}\quad\Longrightarrow\quad
\tilde{B}_0(0)=0.
\end{equation}

With the secular terms eliminated we're left with
\begin{equation}
f_{1\;t,t}+f_1 =0
\end{equation}
which has the solution
\begin{equation}\label{eq:2_f1}
f_1=A_1(\tau_1, \tau_2)\cos(t)+B_1(\tau_1, \tau_2)\sin(t),
\end{equation}
much like $f_0$. The initial conditions here are
\begin{equation}
f_1(0, 0, 0)=0\quad\Longleftrightarrow\quad
A_1(0, 0)=0,
\end{equation}
and
\begin{equation}
\begin{aligned}
f_{1\;t}=-f_{0\;\tau_1}
\quad\Longleftrightarrow\quad
B_1(0, 0) =& \qty[+\ee^{-\tau_1}\qty(
\tilde{A}_0(\tau_2)\cos(t)+\tilde{B}_0(\tau_2)\sin(t)
)]_{t=\tau_1=\tau_2=0}\\
=&\tilde{A}_0(0)=1.
\end{aligned}
\end{equation}

\subsection{Second solvability condition}
Now to the $\order{\epsilon^2}$ problem. From \eqref{eq:2_DE_f} we get
\begin{equation}
f_{2\;t,t}+f_2 + 2f_{1\;t,\tau_1} +2f_{1\;t}
+f_{0\;\tau_1,\tau_1}+2f_{0\;t,\tau_2}+2f_{0\;\tau_1}
=0.
\end{equation}
This equation has a recemblance to \eqref{eq:2c_f1_0}, only with
$f_i\to f_{i+1}$ and some new terms with $f_0$'s. We also know that
$f_1$ has the same form as $f_0$, c.f. \eqref{eq:2_f0} and
\eqref{eq:2_f1}. This means that we can eliminate the secular terms
coming from the $f_1$ terms in the same way as in
\eqref{eq:2c_f1_1}. 

All that we're left with is
\begin{equation}
\begin{aligned}
f_{2\;t,t}+f_2 =& %2f_{1\;t,\tau_1} +2f_{1\;t}
-f_{0\;\tau_1,\tau_1}-2f_{0\;t,\tau_2}-2f_{0\;\tau_1}\\
=& -\ee^{-\tau_1}
\qty[\tilde{A}_0(\tau_2)\cos(t)+\tilde{B}_0(\tau_2)\sin(t)]\\
&-2\ee^{-\tau_1}
\qty[-\tilde{A}_{0\;\tau_2}(\tau_2)\sin(t)+\tilde{B}_{0\;\tau_2}(\tau_2)\cos(t)]\\
&+2\ee^{-\tau_1}
\qty[\tilde{A}_{0}(\tau_2)\cos(t)+\tilde{B}_0(\tau_2)\sin(t)].
\end{aligned}
\end{equation}
Elimiating the secular terms means that the coefficients before
$\cos(t)$ and $\sin(t)$ must be 0. That is
\begin{equation}
\begin{cases}
1\tilde{A}_{0}-2\tilde{B}_{0}'=0\\
1\tilde{B}_{0}+2\tilde{A}_{0}'=0,
\end{cases}
\end{equation}
where ``prime'' now denotes $\dv*{\tau_2}$ since $\tilde{A}_0$ and
$\tilde{B}_0$ only depends on $\tau_2$.
From this we get
\begin{equation}
\tilde{A}_{0}'=2\tilde{B}_{0}''
\end{equation}
which when substitued into the second equation gives
\begin{equation}
\tilde{B}_0+4\tilde{B}_0''=0.
\end{equation}
This DE has the solution
\begin{equation}
\tilde{B}_0=a\cos(\frac{\tau_2}{2})+b\sin(\frac{\tau_2}{2}).
\end{equation}
Now the initial condition \eqref{eq:2_init_tildeB} gives $a=0$. We
also have
\begin{equation}
\tilde{A}_{0}=2\tilde{B}_{0}'=b\cos(\frac{\tau_2}{2}).
\end{equation}
And the initial condition \eqref{eq:2_init_tildeA} gives $b=1$.

Finaly the full expression for $f_0$ is
\begin{equation}
\begin{aligned}
f_0(t, \tau_1, \tau_2)=&A_0(\tau_1, \tau_2)\cos(t)+B_0(\tau_1, \tau_2)\sin(t)\\
=&\ee^{-\tau_1}
\qty[\tilde{A}_0(\tau_2)\cos(t)+\tilde{B}_0(\tau_2)\sin(t)]\\
=&\ee^{-\tau_1}
\qty[\cos(\frac{\tau_2}{2})\cos(t)+\sin(\frac{\tau_2}{2})\sin(t)]
=\ee^{-\tau_1}\cos(t-\frac{\tau_2}{2}).
\end{aligned}
\end{equation}
Or, in only terms of $t$:
\begin{equation}
x(t)=\ee^{-\epsilon t}\cos(\qty(1-\epsilon^2/2)t).
\end{equation}
This can be compared to the exact solution
\begin{equation}
\begin{aligned}
x_\text{exact}(t)=&
\frac{\ee^{-\epsilon t}}{\sqrt{1-\epsilon^2}} \qty[
\sqrt{1-\epsilon^2}\cos(t\sqrt{1-\epsilon^2})
+\epsilon\sin(t\sqrt{1-\epsilon^2})
]\\ \approx&
\ee^{-\epsilon t}}\qty[
\cos(t\qty(1-\epsilon^2/2))
].
\end{aligned}
\end{equation}
The approximation comes from discarding all $\order{\epsilon}$ terms
outside the cosine and the doing a first order Taylor expansion of
$\sqrt{1-\epsilon^2}$. 


\section{Free Duffing oscillator}

\begin{equation}
x''+x=\epsilon {x}^3+;\qquad
x(0)=0,\quad {x'}(0)=0
\end{equation}

\section{Another oscillator}

\begin{equation}
y''+y=\epsilon y^2;\qquad
y(0)=1,\quad y'(0)=0
\end{equation}

\subsection{RPT}

\subsection{The Poincaré-Lindstedt method}

\subsection{Pritulo's method}



\section{Non-linear pendulum, with Pritulo's technique}

\begin{equation}
\theta''+\sin\theta =0;\qquad
\theta(0)=a,\quad \theta'(0)=0
\end{equation}


\section{Linear dsipersive wave}


\begin{equation}
\eta_t + c_0\eta_{x}+\beta\eta_{xxx}=0
\end{equation}

\begin{equation}
\eta(x, 0)=\eta_0(x)=A(\epsilon x)\cos(kx)
\end{equation}


\end{document}



